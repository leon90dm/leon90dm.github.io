---
layout:     post
title:      "è’™ç‰¹å¡æ´›ï¼ˆMCMCï¼‰"
subtitle:   ""
date:       2020-01-16
author:     "BilboDai"
catalog: true
tags:
    - probability
---

### What is MC

è’™ç‰¹å¡æ´›æ–¹æ³•æ˜¯ä¸€ç§é€šè¿‡éšæœºé‡‡æ ·ï¼ˆæˆ–é€šè¿‡æ¨¡æ‹Ÿéšæœºå˜é‡ï¼‰è§£å†³æ•°å­¦é—®é¢˜çš„æ•°å€¼æ–¹æ³•ã€‚

è’™ç‰¹å¡æ´›æ–¹æ³•è§£å†³çš„ä¸¤å¤§ç±»é—®é¢˜ï¼š

1. æ¨¡æ‹Ÿ

   å¦‚æœè¦è®¡ç®—ä»å®¶é‡Œåˆ°å…¬å¸æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¾‹å¦‚åœ¨æ—…é€”ä¸­ä¸‹é›¨æˆ–ä¸‹é›ªçš„å¯èƒ½æ€§ï¼Œäº¤é€šé˜»å¡çš„å¯èƒ½æ€§ï¼Œæ‚¨å°†ä¸å¾—ä¸åœæ­¢åŠ æ²¹ç­‰æ“ä½œã€‚å¯ä»¥åœ¨æ¨¡æ‹Ÿå¼€å§‹æ—¶è®¾ç½®è¿™äº›æ¡ä»¶ï¼Œå¹¶è¿è¡Œæ¨¡æ‹Ÿ1,000æ¬¡ä»¥è·å–ä¼°è®¡çš„æ—¶é—´ã€‚ä¸å¾€å¸¸ä¸€æ ·ï¼Œè¿è¡Œæˆ–è¯•éªŒçš„æ¬¡æ•°è¶Šå¤šï¼Œä¼°è®¡å°±è¶Šå¥½ã€‚

2. ç§¯åˆ†

   

### æ±‚é˜´å½±éƒ¨åˆ†é¢ç§¯

<img src="https://tva1.sinaimg.cn/large/006tNbRwly1ga7x0twq7mj30is0egq44.jpg" alt="img" style="zoom: 33%;" />

å¦‚æœæ²¡æœ‰å¾®ç§¯åˆ†çš„çŸ¥è¯†ï¼Œæ„Ÿè§‰æ— ä»ä¸‹æ‰‹ã€‚



### é€šè¿‡è’™ç‰¹å¡æ´› è¿‘ä¼¼æ±‚ <u>**é˜´å½±éƒ¨åˆ†**</u> é¢ç§¯ $$F$$ï¼š

1. éšæœºç”Ÿæˆä¸€ä¸ªç‚¹ $$x$$  å¾—åˆ° $$f(x)$$ï¼Œå¦‚ä¸‹å›¾ã€‚é‚£ä¹ˆé¢ç§¯è¿‘ä¼¼ä¸ºï¼š$$f(x)\cdot (b-a)$$  è¿™ç§è¿‘ä¼¼éå¸¸çš„ç²—ç•¥ã€‚

   <img src="https://tva1.sinaimg.cn/large/006tNbRwly1ga7x21y35xj30hi0ga0up.jpg" alt="img" style="zoom: 33%;" />

2. åœ¨ $$[a,b]$$ ä¹‹é—´å‡åŒ€çš„ç”Ÿæˆ $$n$$ ä¸ªéšæœºç‚¹ï¼š$$x_1, x_2, \dots x_n$$ï¼Œå¦‚ä¸‹å›¾ï¼š

   ![img](https://tva1.sinaimg.cn/large/006tNbRwly1ga7x3itnh0j30im05wwf7.jpg)

3. æ•´ä½“é˜´å½±é¢ç§¯è¿‘ä¼¼ä¸ºï¼š $$\frac{1}{n}\sum_i^nf(x_i)\cdot(b-a)$$



### Basic Monte Carlo Estimator

$$
\left\langle F^{N}\right\rangle=(b-a) \frac{1}{N} \sum_{i=0}^{N-1} f\left(X_{i}\right)
$$



è¿‘ä¼¼çš„åŸç†ä¸ºï¼šå½“ $$N \rightarrow \infty$$ æ—¶ï¼Œ $$\left\langle F^{N}\right\rangle = F$$  çš„æ¦‚ç‡ä¸º 1ï¼š


$$
\operatorname{Pr}\left(\lim _{N \rightarrow \infty}\left\langle F^{N}\right\rangle= F\right)=1
$$


$$N$$ æ˜¯æ ·æœ¬çš„å¤§å°ã€ $$X_i$$ æ˜¯ $$[a, b]$$ ä¹‹é—´çš„éšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°å¯ä»¥å¾ˆç®€å•çš„ä»ä¸‹é¢å¼å­å¾—åˆ°ï¼š


$$
X_{i}=a+\xi(b-a)
$$


å…¶ä¸­ $$\xi$$ æ˜¯ä¸€ä¸ª $$[0,1]$$ å‡åŒ€éšæœºå‘ç”Ÿå™¨ã€‚



ğŸ‘‰ å¼ $$\operatorname{Pr}\left(\lim _{N \rightarrow \infty}\left\langle F^{N}\right\rangle= F\right)=1$$ çš„è¯æ˜å¦‚ä¸‹ï¼š


$$
\begin{aligned}
E\left[\left\langle F^{N}\right\rangle\right] &=E\left[(b-a) \frac{1}{N} \sum_{i=0}^{N-1} f\left(x_{i}\right)\right] \\
&=(b-a) \frac{1}{N} \sum_{i=0}^{N-1} E[f(x)] \\
&=(b-a) \frac{1}{N} \sum_{i=0}^{N-1} \int_{a}^{b} f(x)\ pdf[ f(x) ] d x \\
&=(b-a) \frac{1}{N} \sum_{i=0}^{N-1} \int_{a}^{b} f(x) \frac{1}{b-a} d x \\
&=\frac{1}{N} \sum_{i=0}^{N-1} \int_{a}^{b} f(x) d x \\
&=\int_{a}^{b} f(x) d x \\
&=F
\end{aligned}
$$


## Generalization Monte Carlo Estimator

$$
\left\langle F^{N}\right\rangle=\frac{1}{N} \sum_{i=0}^{N-1} \frac{f\left(X_{i}\right)}{p d f\left(X_{i}\right)}
$$



è¯æ˜è¿™ä¸ªé€šç”¨çš„å¼å­ï¼š


$$
\begin{aligned}
F 
&= \int_{\omega} f(x) dx \\
&= \int_{\Omega} \underbrace{ \Big[\frac{f(x)}{pdf(x)}\Big] }_{g(x)} pdf(x)\ dx \\
&= \int_{\Omega} g(x)\ pdf(x) dx \\
&= E[g(x)] \\
&= \overbrace{\frac{1}{N}\sum_{i=1}^{N}g(X_i);\ N \rightarrow \infty}^{\text{the law of large numbers}}  \\
&= \frac{1}{N}\sum_{i=1}^{N}\frac{f(X_i)}{pdf(X_i)}
\end{aligned}
$$


æ•´ä¸ªè¯æ˜è¿‡ç¨‹ç”¨åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒå–å·§çš„ **éšæœºå‡½æ•°**  $$pdf(x)$$  ä»¥åŠ å¤§æ•°å®šå¾‹ã€‚ é€šè¿‡è¿™ä¸ªé€šç”¨çš„å¼å­å›å¤´å»çœ‹ æ±‚å–é¢ç§¯çš„è¿‡ç¨‹ï¼Œæ›´æ¸…æ™°ã€‚


$$
\begin{aligned}
F 
&= \frac{1}{N}\sum_{i=1}^{N}\frac{f(X_i)}{1/(b-a)} \\
&= \sum_{i=1}^{N}\frac{(b-a)f(X_i)}{N}
\end{aligned}
$$


### é‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦é™¤ä»¥ä¸åŒçš„ $$pdf(x)$$ ?

éšæœºå˜é‡ $$X_i$$ äº§ç”Ÿ $$x_i$$ã€‚ ä½†å½“åœ¨æŠ½æ ·çš„æ—¶å€™ï¼Œæ ·æœ¬å¹¶ä¸ä¸€å®šæ˜¯å‡åŒ€åˆ†å¸ƒçš„ã€‚å¦‚ä¸‹ï¼š

![img](https://tva1.sinaimg.cn/large/006tNbRwly1gb1pltuvasj308c08cglq.jpg)



### 







